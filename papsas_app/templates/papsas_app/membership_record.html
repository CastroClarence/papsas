{% extends 'papsas_app/layout.html' %}
{% load static %}

{% block head %}
<link rel="stylesheet" href="{% static 'papsas_app/datatable.css' %}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block body %}
<div class="data-table-container">
    <div class="data-table">
        <h1>Membership Record</h1>
        <table>
            <tr>
                <th>Member</th>
                <th>Membership</th>
                <th>Registration Date</th>
                <th>Expiration Date</th>
                <th>Receipt</th>
                <th>Verification ID</th>
                <th>Verification Status</th>
                <th>Action</th>
            </tr>
            {% for row in record %}
                {% if row %}
                <tr>
                    <td><a href="">{{ row.user.id }}</a></td>
                    <td>{{ row.membership }}</td>
                    <td>{{ row.registrationDate }}</td>
                    <td>{{ row.expirationDate }}</td>
                    <td><a href="" class="receipt-link" data-id="{{ row.user.id }}">View Receipt</a></td>
                    <td><a href="" class="id-link" data-id="{{ row.user.id }}">View ID</a></td>
                    <td>{{ row.membershipVerification }}</td>
                    <td>
                        {% if not row.membershipVerification %}
                        <form action="{% url 'approve_membership' row.user.id %}" method="post" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="action-icon" title="Approve">
                                <i class="fas fa-check"></i>
                            </button>
                        </form>
                        <form action="{% url 'delete_membership' row.user.id %}" method="post" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="action-icon" title="Delete">
                                <i class="fas fa-trash-alt"></i>
                            </button>
                        </form>
                        {% else %}
                        <form action="{% url 'decline_membership' row.user.id %}" method="post" style="display:inline;">
                            {% csrf_token %}
                            <button type="submit" class="action-icon" title="Decline">
                                <i class="fas fa-times"></i>
                            </button>
                        </form>
                        {% endif %}
                    </td>
                </tr>
                {% endif %}
            {% endfor %}
        </table>
        {% if not record %}
        <div class="no-existing">
            <p>No existing record.</p>
        </div>
        {% endif %}
    </div>

    <div id="receipt-container" class="modal">
        <h2> Receipt </h2>
        <button class="close-modal"> Close </button>
        <img id="receipt-img" src="" alt="">
    </div>

    <div id="id-container" class="modal">
        <h2> Identification </h2>
        <button class="close-modal"> Close </button>
        <img id="id-img" src="" alt="">
    </div>
</div>
{% endblock %}

{% block script %}
<script src="{% static 'papsas_app/js/record.js' %}"></script>
{% endblock %}
